{% extends 'base.html' %}
{% block title %}Product Detail{% endblock %}
{% block content %}
        <div class="container">
            <div class="row">
                <div class="col-mb" style="padding-bottom:20px; padding-right:10px; margin: auto;">
                    <img src="{{product.image.url}}" width="100%">
                </div>
                <div class="col" style="width:100%;">
                    <div class="row">
                    <h1 class="display-6" style="width:fit-content;">{{product.name}}</h1>
                    {% if product.product_state == 0 %}
                    <div class="badge badge-primary" style="height:20px; margin: auto 0px;">판매중</div>
                    <form method="post" action="/deploy_contract">
                        {% csrf_token %}
                        <input type="hidden" name="id" value="{{ product.id }}">
                        <input type="hidden" name="sell" value="{{ product.user_id }}">
                        <input type="text" name="pw" style=" height: 20px;" placeholder="지갑비밀번호">
                        <button class="badge badge-info" style="height:20px; margin: auto 0px;">구매하기</button>
                    </form>
                    <!-- <button onclick="location.href=''" type="button" class="btn btn-">구매하기</a> -->
                {% elif product.product_state == 1%}    
                    <div class="badge badge-warning" style="height:20px; margin: auto 0px;">거래중</div>
                    <form method="post" action="/buy_contract">
                        {% csrf_token %}
                        <input type="hidden" name="id" value="{{ product.id }}">
                        <input type="hidden" name="sell" value="{{ product.user_id }}">
                        <input type="text" name="pw" style=" height: 20px;" placeholder="지갑비밀번호">
                        <button class="badge badge-info" style="height:20px; margin: auto 0px;">거래확정</button>
                    </form>
                {% elif product.product_state == 2 %}
                    <div class="badge badge-success" style="height:20px; margin: auto 0px;">거래완료</div>
                {% endif %}
                <hr style="border-color: gray; width: 100%; margin-top: 0rem;">
                </div>
                    <p><span class="badge badge-secondary">Price</span> {{product.price}}</p>
{#                    <form action="" method="post">#}
                    <form action="{% url 'cart:product_add' product.id %}" method="post">
                        {{add_to_cart}}
                        {% csrf_token %}
                        <input type="submit" class="btn btn-primary btn-sm" value="Add to Cart" style="margin : 3px;">
                    </form>
                    <br>
                    <!-- <h5><span class="badge badge-secondary">Description</span>{{product.description|linebreaks}}</h5> -->
                    <h5><span class="badge badge-light"><h3>Description</h3></span>
                        <hr size="5px" width="60%" align="left" color="#555555"  style="margin-top: 0rem;">
                        {{product.description|linebreaks}}</h5>
                </div>
                <!-- <div class="row" style="position:relative;">
                {% if user.username == product.user_id %}
                
                <div class="row">
                    <form action="{{product.get_absolute_url}}" method="post">
                        {% csrf_token %}
                        <button value="del" name="is_del" class="btn btn-primary btn-sm" style="margin-top: 10px; margin-right:10px;"> 게시글 삭제</button>
                        {% if product.product_state == 1%}
                            <a href="" type="button"> 거래취소 </a>
                        {% endif %}
                    </form>
                    <button onclick="location.href='update'" class="btn btn-primary btn-sm" style="margin-top: 10px; margin-right:10px;"> 게시글 수정 </a>
                    </div>    
                </div>   

                {% endif %}
                </div>
            </div> -->

            </div>
            <div class="row" style="position:relative;">
                    {% if user.username == product.user_id %}
                    
                    <div class="row" style="margin: auto;">
                        <form action="{{product.get_absolute_url}}" method="post">
                            {% csrf_token %}
                            <button value="del" name="is_del" class="btn btn-primary btn-sm" style="margin-top: 10px; margin-right:10px;"> 게시글 삭제</button>
                            {% if product.product_state == 1%}
                                <a href="" type="button"> 거래취소 </a>
                            {% endif %}
                        </form>
                        <button onclick="location.href='update'" class="btn btn-primary btn-sm" style="margin-top: 10px; margin-right:10px;"> 게시글 수정 </button>
                        </div>    
            </div>   

                {% endif %}
        </div>
            </div>



{% endblock %}